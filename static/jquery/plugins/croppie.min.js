(function(a,b){if(typeof define==="function"&&define.amd){define(["exports"],b)}else{if(typeof exports==="object"&&typeof exports.nodeName!=="string"){b(exports)}else{b((a.commonJsStrict={}))}}}(this,function(Q){if(typeof Promise!=="function"){
/*! promise-polyfill 3.1.0 */
;!function(am){function al(ao,an){return function(){ao.apply(an,arguments)}}function ak(an){if("object"!=typeof this){throw new TypeError("Promises must be constructed via new")}if("function"!=typeof an){throw new TypeError("not a function")}this._state=null,this._value=null,this._deferreds=[],ae(an,al(ai,this),al(ah,this))}function aj(ao){var an=this;return null===this._state?void this._deferreds.push(ao):void ac(function(){var ar=an._state?ao.onFulfilled:ao.onRejected;if(null===ar){return void (an._state?ao.resolve:ao.reject)(an._value)}var aq;try{aq=ar(an._value)}catch(ap){return void ao.reject(ap)}ao.resolve(aq)})}function ai(an){try{if(an===this){throw new TypeError("A promise cannot be resolved with itself.")}if(an&&("object"==typeof an||"function"==typeof an)){var ap=an.then;if("function"==typeof ap){return void ae(al(ap,an),al(ai,this),al(ah,this))}}this._state=!0,this._value=an,ag.call(this)}catch(ao){ah.call(this,ao)}}function ah(an){this._state=!1,this._value=an,ag.call(this)}function ag(){for(var ao=0,an=this._deferreds.length;an>ao;ao++){aj.call(this,this._deferreds[ao])}this._deferreds=null}function af(ao,an,aq,ap){this.onFulfilled="function"==typeof ao?ao:null,this.onRejected="function"==typeof an?an:null,this.resolve=aq,this.reject=ap}function ae(ao,an,ar){var aq=!1;try{ao(function(at){aq||(aq=!0,an(at))},function(at){aq||(aq=!0,ar(at))})}catch(ap){if(aq){return}aq=!0,ar(ap)}}var ad=setTimeout,ac="function"==typeof setImmediate&&setImmediate||function(an){ad(an,1)},ab=Array.isArray||function(an){return"[object Array]"===Object.prototype.toString.call(an)};ak.prototype["catch"]=function(an){return this.then(null,an)},ak.prototype.then=function(ao,an){var ap=this;return new ak(function(ar,aq){aj.call(ap,new af(ao,an,ar,aq))})},ak.all=function(){var an=Array.prototype.slice.call(1===arguments.length&&ab(arguments[0])?arguments[0]:arguments);return new ak(function(ao,at){function ar(ax,aw){try{if(aw&&("object"==typeof aw||"function"==typeof aw)){var av=aw.then;if("function"==typeof av){return void av.call(aw,function(ay){ar(ax,ay)},at)}}an[ax]=aw,0===--aq&&ao(an)}catch(au){at(au)}}if(0===an.length){return ao([])}for(var aq=an.length,ap=0;ap<an.length;ap++){ar(ap,an[ap])}})},ak.resolve=function(an){return an&&"object"==typeof an&&an.constructor===ak?an:new ak(function(ao){ao(an)})},ak.reject=function(an){return new ak(function(ao,ap){ap(an)})},ak.race=function(an){return new ak(function(ao,ar){for(var aq=0,ap=an.length;ap>aq;aq++){an[aq].then(ao,ar)}})},ak._setImmediateFn=function(an){ac=an},"undefined"!=typeof module&&module.exports?module.exports=ak:am.Promise||(am.Promise=ak)}(this)}if(typeof window.CustomEvent!=="function"){(function(){function ab(ad,ae){ae=ae||{bubbles:false,cancelable:false,detail:undefined};var ac=document.createEvent("CustomEvent");ac.initCustomEvent(ad,ae.bubbles,ae.cancelable,ae.detail);return ac}ab.prototype=window.Event.prototype;window.CustomEvent=ab}())}if(!HTMLCanvasElement.prototype.toBlob){Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(ah,af,ag){var ad=atob(this.toDataURL(af,ag).split(",")[1]),ac=ad.length,ab=new Uint8Array(ac);for(var ae=0;ae<ac;ae++){ab[ae]=ad.charCodeAt(ae)}ah(new Blob([ab],{type:af||"image/png"}))}})}var W=["Webkit","Moz","ms"],Y=document.createElement("div").style,U,F,m;function o(ad){if(ad in Y){return ad}var ac=ad[0].toUpperCase()+ad.slice(1),ab=W.length;while(ab--){ad=W[ab]+ac;if(ad in Y){return ad}}}F=o("transform");U=o("transformOrigin");m=o("userSelect");function N(ab,ad){ab=ab||{};for(var ac in ad){if(ad[ac]&&ad[ac].constructor&&ad[ac].constructor===Object){ab[ac]=ab[ac]||{};N(ab[ac],ad[ac])}else{ab[ac]=ad[ac]}}return ab}function j(ac,ae,ab){var ad;return function(){var ai=this,ah=arguments;var ag=function(){ad=null;if(!ab){ac.apply(ai,ah)}};var af=ab&&!ad;clearTimeout(ad);ad=setTimeout(ag,ae);if(af){ac.apply(ai,ah)}}}function E(ac){if("createEvent" in document){var ab=document.createEvent("HTMLEvents");ab.initEvent("change",false,true);ac.dispatchEvent(ab)}else{ac.fireEvent("onchange")}}function P(ac,ad,ae){if(typeof(ad)==="string"){var ab=ad;ad={};ad[ab]=ae}for(var af in ad){ac.style[af]=ad[af]}}function D(ab,ac){if(ab.classList){ab.classList.add(ac)}else{ab.className+=" "+ac}}function s(ab,ac){if(ab.classList){ab.classList.remove(ac)}else{ab.className=ab.className.replace(ac,"")}}function Z(ab){return parseInt(ab,10)}function y(ae,af,ad){var ac=af||new Image(),ab;if(ac.src===ae){ab=new Promise(function(ah,ag){ah(ac)})}else{ab=new Promise(function(ah,ag){if(ad&&ae.substring(0,4).toLowerCase()==="http"){ac.setAttribute("crossOrigin","anonymous")}ac.onload=function(){setTimeout(function(){ah(ac)},1)}});ac.src=ae}ac.style.opacity=0;return ab}var h="translate3d",e=", 0px";var X=function(ab,ad,ac){this.x=parseFloat(ab);this.y=parseFloat(ad);this.scale=parseFloat(ac)};X.parse=function(ab){if(ab.style){return X.parse(ab.style[F])}else{if(ab.indexOf("matrix")>-1||ab.indexOf("none")>-1){return X.fromMatrix(ab)}else{return X.fromString(ab)}}};X.fromMatrix=function(ab){var ac=ab.substring(7).split(",");if(!ac.length||ab==="none"){ac=[1,0,0,1,0,0]}return new X(Z(ac[4]),Z(ac[5]),parseFloat(ac[0]))};X.fromString=function(ad){var ac=ad.split(") "),af=ac[0].substring(h.length+1).split(","),ae=ac.length>1?ac[1].substring(6):1,ab=af.length>1?af[0]:0,ag=af.length>1?af[1]:0;return new X(ab,ag,ae)};X.prototype.toString=function(){return h+"("+this.x+"px, "+this.y+"px"+e+") scale("+this.scale+")"};var a=function(ac){if(!ac||!ac.style[U]){this.x=0;this.y=0;return}var ab=ac.style[U].split(" ");this.x=parseFloat(ab[0]);this.y=parseFloat(ab[1])};a.prototype.toString=function(){return this.x+"px "+this.y+"px"};function aa(ac,ab){if(!window.EXIF){ab(0)}EXIF.getData(ac,function(){var ad=EXIF.getTag(this,"Orientation");ab(ad)})}function S(af,ae,ad){var ag=ae.width,ab=ae.height,ac=af.getContext("2d");af.width=ae.width;af.height=ae.height;ac.save();switch(ad){case 2:ac.translate(ag,0);ac.scale(-1,1);break;case 3:ac.translate(ag,ab);ac.rotate(180*Math.PI/180);break;case 4:ac.translate(0,ab);ac.scale(1,-1);break;case 5:af.width=ab;af.height=ag;ac.rotate(90*Math.PI/180);ac.scale(1,-1);break;case 6:af.width=ab;af.height=ag;ac.rotate(90*Math.PI/180);ac.translate(0,-ab);break;case 7:af.width=ab;af.height=ag;ac.rotate(-90*Math.PI/180);ac.translate(-ag,ab);ac.scale(1,-1);break;case 8:af.width=ab;af.height=ag;ac.translate(0,ag);ac.rotate(-90*Math.PI/180);break}ac.drawImage(ae,0,0,ag,ab);ac.restore()}function A(){var ak=this,ae="croppie-container",ab=ak.options.viewport.type?"cr-vp-"+ak.options.viewport.type:null,ac,ah,ai,ag,ad,aj,af;ak.options.useCanvas=ak.options.enableOrientation||v.call(ak);ak.data={};ak.elements={};ac=ak.elements.boundary=document.createElement("div");ai=ak.elements.viewport=document.createElement("div");ah=ak.elements.img=document.createElement("img");ag=ak.elements.overlay=document.createElement("div");if(ak.options.useCanvas){ak.elements.canvas=document.createElement("canvas");ak.elements.preview=ak.elements.canvas}else{ak.elements.preview=ak.elements.img}D(ac,"cr-boundary");aj=ak.options.boundary.width;af=ak.options.boundary.height;P(ac,{width:(aj+(isNaN(aj)?"":"px")),height:(af+(isNaN(af)?"":"px"))});D(ai,"cr-viewport");if(ab){D(ai,ab)}P(ai,{width:ak.options.viewport.width+"px",height:ak.options.viewport.height+"px"});ai.setAttribute("tabindex",0);D(ak.elements.preview,"cr-image");D(ag,"cr-overlay");ak.element.appendChild(ac);ac.appendChild(ak.elements.preview);ac.appendChild(ai);ac.appendChild(ag);D(ak.element,ae);if(ak.options.customClass){D(ak.element,ak.options.customClass)}w.call(this);if(ak.options.enableZoom){V.call(ak)}}function c(){return;var ab=this,ae,ac,ad,ag,af;ae=document.createElement("div");ab.elements.orientationBtnLeft=ac=document.createElement("button");ab.elements.orientationBtnRight=ad=document.createElement("button");ae.appendChild(ac);ae.appendChild(ad);ag=document.createElement("i");af=document.createElement("i");ac.appendChild(ag);ad.appendChild(af);D(ae,"cr-rotate-controls");D(ac,"cr-rotate-l");D(ad,"cr-rotate-r");ab.elements.boundary.appendChild(ae);ac.addEventListener("click",function(){ab.rotate(-90)});ad.addEventListener("click",function(){ab.rotate(90)})}function v(){return this.options.enableExif&&window.EXIF}function M(ab){if(this.options.enableZoom){var ad=this.elements.zoomer,ac=L(ab,4);ad.value=Math.max(ad.min,Math.min(ad.max,ac))}}function V(){var ac=this,ad=ac.elements.zoomerWrap=document.createElement("div"),ae=ac.elements.zoomer=document.createElement("input");D(ad,"cr-slider-wrap");D(ae,"cr-slider");ae.type="range";ae.step="0.0001";ae.value=1;ae.style.display=ac.options.showZoomer?"":"none";ac.element.appendChild(ad);ad.appendChild(ae);ac._currentZoom=1;function af(){f.call(ac,{value:parseFloat(ae.value),origin:new a(ac.elements.preview),viewportRect:ac.elements.viewport.getBoundingClientRect(),transform:X.parse(ac.elements.preview)})}function ab(ag){var ai,ah;if(ag.wheelDelta){ai=ag.wheelDelta/1200}else{if(ag.deltaY){ai=ag.deltaY/1060}else{if(ag.detail){ai=ag.detail/-60}else{ai=0}}}ah=ac._currentZoom+(ai*ac._currentZoom);ag.preventDefault();M.call(ac,ah);af.call(ac)}ac.elements.zoomer.addEventListener("input",af);ac.elements.zoomer.addEventListener("change",af);if(ac.options.mouseWheelZoom){ac.elements.boundary.addEventListener("mousewheel",ab);ac.elements.boundary.addEventListener("DOMMouseScroll",ab)}}function f(af){var ak=this,ac=af?af.transform:X.parse(ak.elements.preview),ae=af?af.viewportRect:ak.elements.viewport.getBoundingClientRect(),ah=af?af.origin:new a(ak.elements.preview),ag={};function ad(){var al={};al[F]=ac.toString();al[U]=ah.toString();P(ak.elements.preview,al)}ak._currentZoom=af?af.value:ak._currentZoom;ac.scale=ak._currentZoom;ad();if(ak.options.enforceBoundary){var ab=t.call(ak,ae),aj=ab.translate,ai=ab.origin;if(ac.x>=aj.maxX){ah.x=ai.minX;ac.x=aj.maxX}if(ac.x<=aj.minX){ah.x=ai.maxX;ac.x=aj.minX}if(ac.y>=aj.maxY){ah.y=ai.minY;ac.y=aj.maxY}if(ac.y<=aj.minY){ah.y=ai.maxY;ac.y=aj.minY}}ad();u.call(ak);B.call(ak)}function t(an){var al=this,av=al._currentZoom,ak=an.width,ab=an.height,ah=al.elements.boundary.clientWidth/2,ae=al.elements.boundary.clientHeight/2,au=al.elements.preview.getBoundingClientRect(),ac=au.width,at=au.height,ai=ak/2,am=ab/2;var aq=((ai/av)-ah)*-1;var ar=aq-((ac*(1/av))-(ak*(1/av)));var ao=((am/av)-ae)*-1;var ap=ao-((at*(1/av))-(ab*(1/av)));var aj=(1/av)*ai;var ag=(ac*(1/av))-aj;var af=(1/av)*am;var ad=(at*(1/av))-af;return{translate:{maxX:aq,minX:ar,maxY:ao,minY:ap},origin:{maxX:ag,minX:aj,maxY:ad,minY:af}}}function O(){var al=this,af=al._currentZoom,ag=al.elements.preview.getBoundingClientRect(),ac=al.elements.viewport.getBoundingClientRect(),ad=X.parse(al.elements.preview.style[F]),ak=new a(al.elements.preview),aj=(ac.top-ag.top)+(ac.height/2),ae=(ac.left-ag.left)+(ac.width/2),ab={},ai={};ab.y=aj/af;ab.x=ae/af;ai.y=(ab.y-ak.y)*(1-af);ai.x=(ab.x-ak.x)*(1-af);ad.x-=ai.x;ad.y-=ai.y;var ah={};ah[U]=ab.x+"px "+ab.y+"px";ah[F]=ad.toString();P(al.elements.preview,ah)}function w(){var an=this,ai=false,am,ak,ad,ah,ae;function ab(ap,ao){var aq=an.elements.preview.getBoundingClientRect(),at=ae.y+ao,ar=ae.x+ap;if(an.options.enforceBoundary){if(ah.top>aq.top+ao&&ah.bottom<aq.bottom+ao){ae.y=at}if(ah.left>aq.left+ap&&ah.right<aq.right+ap){ae.x=ar}}else{ae.y=at;ae.x=ar}}function aj(au){var av=37,aw=38,ap=39,ar=40;if(au.shiftKey&&(au.keyCode==aw||au.keyCode==ar)){var at=0;if(au.keyCode==aw){at=parseFloat(an.elements.zoomer.value,10)+parseFloat(an.elements.zoomer.step,10)}else{at=parseFloat(an.elements.zoomer.value,10)-parseFloat(an.elements.zoomer.step,10)}an.setZoom(at)}else{if(au.keyCode>=37&&au.keyCode<=40){au.preventDefault();var aq=ao(au.keyCode);ae=X.parse(an.elements.preview);document.body.style[m]="none";ah=an.elements.viewport.getBoundingClientRect();ac(aq)}}function ao(ax){switch(ax){case av:return[1,0];case aw:return[0,1];case ap:return[-1,0];case ar:return[0,-1]}}}function ac(aq){var ap=aq[0],ao=aq[1],ar={};ab(ap,ao);ar[F]=ae.toString();P(an.elements.preview,ar);H.call(an);document.body.style[m]="";O.call(an);B.call(an);ad=0}function af(ao){ao.preventDefault();if(ai){return}ai=true;am=ao.pageX;ak=ao.pageY;if(ao.touches){var ap=ao.touches[0];am=ap.pageX;ak=ap.pageY}ae=X.parse(an.elements.preview);window.addEventListener("mousemove",al);window.addEventListener("touchmove",al);window.addEventListener("mouseup",ag);window.addEventListener("touchend",ag);document.body.style[m]="none";ah=an.elements.viewport.getBoundingClientRect()}function al(az){az.preventDefault();var ar=az.pageX,ap=az.pageY;if(az.touches){var av=az.touches[0];ar=av.pageX;ap=av.pageY}var at=ar-am,aq=ap-ak,au={};if(az.type=="touchmove"){if(az.touches.length>1){var ax=az.touches[0];var aw=az.touches[1];var ay=Math.sqrt((ax.pageX-aw.pageX)*(ax.pageX-aw.pageX)+(ax.pageY-aw.pageY)*(ax.pageY-aw.pageY));if(!ad){ad=ay/an._currentZoom}var ao=ay/ad;M.call(an,ao);E(an.elements.zoomer);return}}ab(at,aq);au[F]=ae.toString();P(an.elements.preview,au);H.call(an);ak=ap;am=ar}function ag(){ai=false;window.removeEventListener("mousemove",al);window.removeEventListener("touchmove",al);window.removeEventListener("mouseup",ag);window.removeEventListener("touchend",ag);document.body.style[m]="";O.call(an);B.call(an);ad=0}an.elements.overlay.addEventListener("mousedown",af);an.elements.viewport.addEventListener("keydown",aj);an.elements.overlay.addEventListener("touchstart",af)}function H(){var ac=this,ab=ac.elements.boundary.getBoundingClientRect(),ad=ac.elements.preview.getBoundingClientRect();P(ac.elements.overlay,{width:ad.width+"px",height:ad.height+"px",top:(ad.top-ab.top)+"px",left:(ad.left-ab.left)+"px"})}var u=j(H,500);function B(){var ab=this,ad=ab.get(),ac;if(!R.call(ab)){return}ab.options.update.call(ab,ad);if(ab.$){ab.$(ab.element).trigger("update",ad)}else{var ac;if(window.CustomEvent){ac=new CustomEvent("update",{detail:ad})}else{ac=document.createEvent("CustomEvent");ac.initCustomEvent("update",true,true,ad)}ab.element.dispatchEvent(ac)}}function R(){return this.elements.preview.offsetHeight>0&&this.elements.preview.offsetWidth>0}function z(){var ap=this,ab=0,am=1.5,an=1,af={},aj=ap.elements.preview,ai=ap.elements.zoomer,ah=new X(0,0,an),al=new a(),ak=R.call(ap),ac,ad,ae,ag,aq;if(!ak||ap.data.bound){return}ap.data.bound=true;af[F]=ah.toString();af[U]=al.toString();af.opacity=1;P(aj,af);ac=aj.getBoundingClientRect();ad=ap.elements.viewport.getBoundingClientRect();ae=ap.elements.boundary.getBoundingClientRect();ap._originalImageWidth=ac.width;ap._originalImageHeight=ac.height;if(ap.options.enableZoom){if(ap.options.enforceBoundary){ag=ad.width/ac.width;aq=ad.height/ac.height;ab=Math.max(ag,aq)}if(ab>=am){am=ab+1}ai.min=L(ab,4);ai.max=L(am,4);var ao=Math.max((ae.width/ac.width),(ae.height/ac.height));an=ap.data.boundZoom!==null?ap.data.boundZoom:ao;M.call(ap,an);E(ai)}else{ap._currentZoom=an}ah.scale=ap._currentZoom;af[F]=ah.toString();P(aj,af);if(ap.data.points.length){K.call(ap,ap.data.points)}else{n.call(ap)}O.call(ap);H.call(ap)}function K(aj){if(aj.length!=4){throw"Croppie - Invalid number of points supplied: "+aj}var am=this,ab=aj[2]-aj[0],ad=am.elements.viewport.getBoundingClientRect(),ac=am.elements.boundary.getBoundingClientRect(),ae={left:ad.left-ac.left,top:ad.top-ac.top},ag=ad.width/ab,al=aj[1],af=aj[0],ai=(-1*aj[1])+ae.top,ak=(-1*aj[0])+ae.left,ah={};ah[U]=af+"px "+al+"px";ah[F]=new X(ak,ai,ag).toString();P(am.elements.preview,ah);M.call(am,ag);am._currentZoom=ag}function n(){var aj=this,af=aj.elements.preview.getBoundingClientRect(),ab=aj.elements.viewport.getBoundingClientRect(),ah=aj.elements.boundary.getBoundingClientRect(),ac=ab.left-ah.left,ae=ab.top-ah.top,ai=ac-((af.width-ab.width)/2),ag=ae-((af.height-ab.height)/2),ad=new X(ai,ag,aj._currentZoom);P(aj.elements.preview,F,ad.toString())}function l(af){var ad=this,ae=ad.elements.canvas,ac=ad.elements.img,ab=ae.getContext("2d"),ag=v.call(ad),af=ad.options.enableOrientation&&af;ab.clearRect(0,0,ae.width,ae.height);ae.width=ac.width;ae.height=ac.height;if(ag){aa(ac,function(ah){S(ae,ac,Z(ah,10));if(af){S(ae,ac,af)}})}else{if(af){S(ae,ac,af)}}}function C(ah){var an=this,ak=ah.points,af=Z(ak[0]),aj=Z(ak[1]),ac=(ak[2]-ak[0]),al=(ak[3]-ak[1]),ab=ah.circle,ae=document.createElement("canvas"),am=ae.getContext("2d"),ad=ac,ao=al,ai=0,ag=0;if(ah.outputWidth&&ah.outputHeight){ad=ah.outputWidth;ao=ah.outputHeight}ae.width=ad;ae.height=ao;if(ah.backgroundColor){am.fillStyle=ah.backgroundColor;am.fillRect(0,0,ad,ao)}if(af<0){ai=Math.abs(af);af=0}if(aj<0){ag=Math.abs(aj);aj=0}if((af+ac)>an._originalImageWidth){ac=an._originalImageWidth-af;ad=ac}if((aj+al)>an._originalImageHeight){al=an._originalImageHeight-aj;ao=al}am.drawImage(this.elements.preview,af,aj,ac,al,ai,ag,ad,ao);if(ab){am.fillStyle="#fff";am.globalCompositeOperation="destination-in";am.beginPath();am.arc(ad/2,ao/2,ad/2,0,Math.PI*2,true);am.closePath();am.fill()}return ae}function G(af){var ae=af.points,ag=document.createElement("div"),ac=document.createElement("img"),ad=ae[2]-ae[0],ab=ae[3]-ae[1];D(ag,"croppie-result");ag.appendChild(ac);P(ac,{left:(-1*ae[0])+"px",top:(-1*ae[1])+"px"});ac.src=af.url;P(ag,{width:ad+"px",height:ab+"px"});return ag}function r(ab){return C.call(this,ab).toDataURL(ab.format,ab.quality)}function b(ac){var ab=this;return new Promise(function(ae,ad){C.call(ab,ac).toBlob(function(af){ae(af)},ac.format,ac.quality)})}function d(af,ab){var ad=this,ae,ag=[],ah=null;if(typeof(af)==="string"){ae=af;af={}}else{if(Array.isArray(af)){ag=af.slice()}else{if(typeof(af)=="undefined"&&ad.data.url){z.call(ad);B.call(ad);return null}else{ae=af.url;ag=af.points||[];ah=typeof(af.zoom)==="undefined"?null:af.zoom}}}ad.data.bound=false;ad.data.url=ae||ad.data.url;ad.data.points=(ag||ad.data.points).map(function(ai){return parseFloat(ai)});ad.data.boundZoom=ah;var ac=y(ae,ad.elements.img,ad.options.useCanvas);ac.then(function(){if(ad.options.useCanvas){ad.elements.img.exifdata=null;l.call(ad,af.orientation||1)}z.call(ad);B.call(ad);if(ab){ab()}});return ac}function L(ab,ac){return parseFloat(ab).toFixed(ac||0)}function T(){var al=this,ac=al.elements.preview.getBoundingClientRect(),ae=al.elements.viewport.getBoundingClientRect(),ad=ae.left-ac.left,ak=ae.top-ac.top,ah=(ae.width-al.elements.viewport.offsetWidth)/2,ag=(ae.height-al.elements.viewport.offsetHeight)/2,ab=ad+al.elements.viewport.offsetWidth+ah,aj=ak+al.elements.viewport.offsetHeight+ag,af=al._currentZoom;if(af===Infinity||isNaN(af)){af=1}var ai=al.options.enforceBoundary?0:Number.NEGATIVE_INFINITY;ad=Math.max(ai,ad/af);ak=Math.max(ai,ak/af);ab=Math.max(ai,ab/af);aj=Math.max(ai,aj/af);return{points:[L(ad),L(ak),L(ab),L(aj)],zoom:af}}var i={type:"canvas",format:"png",quality:1},q=["jpeg","webp","png"];function J(an){var al=this,af=T.call(al),ab=N(i,N({},an)),ae=(typeof(an)==="string"?an:(ab.type||"base64")),am=ab.size,aj=ab.format,ak=ab.quality,ai=ab.backgroundColor,ac=typeof ab.circle==="boolean"?ab.circle:(al.options.viewport.type==="circle"),ag=al.elements.viewport.getBoundingClientRect(),ah=ag.width/ag.height,ad;if(am==="viewport"){af.outputWidth=ag.width;af.outputHeight=ag.height}else{if(typeof am==="object"){if(am.width&&am.height){af.outputWidth=am.width;af.outputHeight=am.height}else{if(am.width){af.outputWidth=am.width;af.outputHeight=am.width/ah}else{if(am.height){af.outputWidth=am.height*ah;af.outputHeight=am.height}}}}}if(q.indexOf(aj)>-1){af.format="image/"+aj;af.quality=ak}af.circle=ac;af.url=al.data.url;af.backgroundColor=ai;ad=new Promise(function(ap,ao){switch(ae.toLowerCase()){case"rawcanvas":ap(C.call(al,af));break;case"canvas":case"base64":ap(r.call(al,af));break;case"blob":b.call(al,af).then(ap);break;default:ap(G.call(al,af));break}});return ad}function x(){z.call(this)}function g(af){if(!this.options.useCanvas){throw"Croppie: Cannot rotate without enableOrientation"}var ad=this,ae=ad.elements.canvas,ac=ad.elements.img,ah=document.createElement("canvas"),ag=1;ah.width=ae.width;ah.height=ae.height;var ab=ah.getContext("2d");ab.drawImage(ae,0,0);if(af===90||af===-270){ag=6}if(af===-90||af===270){ag=8}if(af===180||af===-180){ag=3}S(ae,ah,ag);f.call(ad)}function k(){var ab=this;ab.element.removeChild(ab.elements.boundary);s(ab.element,"croppie-container");if(ab.options.enableZoom){ab.element.removeChild(ab.elements.zoomerWrap)}delete ab.elements}if(window.jQuery){var I=window.jQuery;I.fn.croppie=function(ae){var ad=typeof ae;if(ad==="string"){var ab=Array.prototype.slice.call(arguments,1);var ac=I(this).data("croppie");if(ae==="get"){return ac.get()}else{if(ae==="result"){return ac.result.apply(ac,ab)}else{if(ae==="bind"){return ac.bind.apply(ac,ab)}}}return this.each(function(){var af=I(this).data("croppie");if(!af){return}var ag=af[ae];if(I.isFunction(ag)){ag.apply(af,ab);if(ae==="destroy"){I(this).removeData("croppie")}}else{throw"Croppie "+ae+" method not found"}})}else{return this.each(function(){var af=new p(this,ae);af.$=I;I(this).data("croppie",af)})}}}function p(ac,ad){this.element=ac;this.options=N(N({},p.defaults),ad);if(this.element.tagName.toLowerCase()==="img"){var ab=this.element;D(ab,"cr-original-image");var af=document.createElement("div");this.element.parentNode.appendChild(af);af.appendChild(ab);this.element=af;this.options.url=this.options.url||ab.src}A.call(this);if(this.options.url){var ae={url:this.options.url,points:this.options.points};delete this.options.url;delete this.options.points;d.call(this,ae)}}p.defaults={viewport:{width:100,height:100,type:"square"},boundary:{},orientationControls:{enabled:true,leftClass:"",rightClass:""},customClass:"",showZoomer:true,enableZoom:true,mouseWheelZoom:true,enableExif:false,enforceBoundary:true,enableOrientation:false,update:function(){}};N(p.prototype,{bind:function(ac,ab){return d.call(this,ac,ab)},get:function(){return T.call(this)},result:function(ab){return J.call(this,ab)},refresh:function(){return x.call(this)},setZoom:function(ab){M.call(this,ab);E(this.elements.zoomer)},rotate:function(ab){g.call(this,ab)},destroy:function(){return k.call(this)}});Q.Croppie=window.Croppie=p;if(typeof module==="object"&&!!module.exports){module.exports=p}}));